sap.ui.define([                                                                                                                                                                                                                                                
	"int/ui5/template/controller/BaseController",                                                                                                                                                                                                                 
	'sap/m/MessageBox',                                                                                                                                                                                                                                           
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
	"sap/ui/model/json/JSONModel",                                                                                                                                                                                                                                
	'sap/ui/unified/CalendarLegendItem',                                                                                                                                                                                                                          
	'sap/ui/unified/DateTypeRange',                                                                                                                                                                                                                               
	'sap/ui/unified/library',                                                                                                                                                                                                                                     
	"sap/ui/model/Filter",                                                                                                                                                                                                                                        
	"sap/ui/model/FilterOperator",                                                                                                                                                                                                                                
], function (BaseController, MessageBox, Filter, Operator, JSONModel, CalendarLegendItem, DateTypeRange, unifiedLibrary) {                                                                                                                                     
	"use strict";                                                                                                                                                                                                                                                 
	var CalendarDayType = unifiedLibrary.CalendarDayType;                                                                                                                                                                                                         
	return BaseController.extend("int.ui5.template.controller.Home", {                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		pressTile: function (oEvent) {                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			var target = oEvent.getSource().data().target;                                                                                                                                                                                                              
			this.getRouter().navTo(target, {}, {}, true);                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onInit: function () {                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
		onAfterRendering: function () {                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onSearch: function (event) {                                                                                                                                                                                                                                 
			this.searchText();                                                                                                                                                                                                                                          
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		searchText: function () {                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
			var filters = [new Filter("SearchString", Operator.EQ, this.getView().byId("inputText").getValue()),                                                                                                                                                        
			new Filter("Package", Operator.EQ, this.getView().byId("inputPackage").getValue())];                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			var busyDialog = new sap.m.BusyDialog({});                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
			var parameters = {                                                                                                                                                                                                                                          
				async: true,                                                                                                                                                                                                                                               
				filters: filters,                                                                                                                                                                                                                                          
				urlParameters: {                                                                                                                                                                                                                                           
					"$expand": ["Files", "Files/Lines"]                                                                                                                                                                                                                       
				},                                                                                                                                                                                                                                                         
				success: function (data) {                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
					var applicationModel = this.getOwnerComponent().getModel("application");                                                                                                                                                                                  
					applicationModel.setData(data.results);                                                                                                                                                                                                                   
					busyDialog.close();                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
				}.bind(this),                                                                                                                                                                                                                                              
				error: function (error) {                                                                                                                                                                                                                                  
					busyDialog.close();                                                                                                                                                                                                                                       
				}.bind(this)                                                                                                                                                                                                                                               
			};                                                                                                                                                                                                                                                          
			busyDialog.open();                                                                                                                                                                                                                                          
			this.getModel("mainModel").read("/OutputSet", parameters);                                                                                                                                                                                                  
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		formatLines: function (lines) {                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
			var returnLine = "";                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
			for (var i = 0; i < lines.results.length; i++) {                                                                                                                                                                                                            
				returnLine = returnLine + "\n" + lines.results[i].Line;                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
			return returnLine;                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            